<?xml version="1.0" encoding="UTF-8" ?>
<Policys>
    <Module>
      <Name>account</Name>
      <Controller1>
        <Rule>
          <Role>CUSTOMER</Role>
          <Action>Put</Action>
          <Resource>Account</Resource>
          <Name>updateAccount</Name>
          <Condition>
            <Restriction>user.account.id === resource.account.id</Restriction>
          </Condition>
        </Rule>
        <Rule>
          <Role>CUSTOMER</Role>
          <Action>Get</Action>
          <Resource>Account</Resource>
          <Name>getAccount</Name>
          <Condition>
            <Restriction>user.id === resource.account.ownerId</Restriction>
          </Condition>
        </Rule>
      </Controller1>
    </Module>

    <Module>
      <Name>loan</Name>
      <Controller1>
        <Rule>
          <Role>LOAN_OFFICER</Role>
          <Action>Post</Action>
          <Resource>LoanApplication</Resource>
          <Name>evaluateLoanApplication</Name>
          <Condition>
            <Restriction>user.id === resource.loanApplication.loanOfficerId</Restriction>
          </Condition>
        </Rule>
        <!-- <Rule>
          <Role>CUSTOMER</Role>
          <Action>Post</Action>
          <Resource>LoanApplication</Resource>
          <Name>applyForLoan</Name>
          <Condition>
            <Restriction>user.id === resource.loanApplication.applicantId</Restriction>
          </Condition>
        </Rule>
        <Rule>
          <Role>CUSTOMER</Role>
          <Action>Get</Action>
          <Resource>LoanApplication</Resource>
          <Name>viewLoanApplication</Name>
          <Condition>
            <Restriction>user.id === resource.loanApplication.applicantId</Restriction>
          </Condition>
        </Rule> -->
      </Controller1>
    </Module>
    <Module>
      <Name>transaction</Name>
      <Controller1>
        <Rule>
          <Role>TELLER</Role>
          <Action>Get</Action>
          <Resource>Transaction</Resource>
          <Name>findTellerTransactions</Name>
          <Condition>
            <Restriction>user.branch.id === resource.transaction.branchId</Restriction>
          </Condition>
        </Rule>
        <Rule>
          <Role>CUSTOMER</Role>
          <Action>Post</Action>
          <Resource>Account</Resource>
          <Name>transferFunds</Name>
          <Condition>
            <Restriction>user.id === resource.sourceAccount.ownerId</Restriction>
          </Condition>
        </Rule>
      </Controller1>
    </Module>
</Policys>